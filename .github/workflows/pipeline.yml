name: Deploy to Hugging Face Space

on:
  push:
    branches:
      - main

jobs:
  deploy:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout Repository
        uses: actions/checkout@v4

      - name: Set up Python
        uses: actions/setup-python@v5
        with:
          python-version: "3.10"

      - name: Install Dependencies
        run: |
          pip install huggingface_hub

      - name: Deploy to Hugging Face Space
        env:
          HF_TOKEN: ${{ secrets.HF_TOKEN }}
        run: |
          python <<EOF
          import os
          from huggingface_hub import HfApi

          api = HfApi()
          SPACE_REPO = "AkhilRaja/engine-condition-space"

          files = ["app.py", "requirements.txt", "Dockerfile"]

          for file in files:
              if os.path.exists(file):
                  api.upload_file(
                      path_or_fileobj=file,
                      path_in_repo=file,
                      repo_id=SPACE_REPO,
                      repo_type="space",
                      token=os.environ["HF_TOKEN"]
                  )

          print("Deployment completed successfully!")
          EOF
